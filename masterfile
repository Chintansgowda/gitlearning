pipeline {
    agent any

    stages {
        stage('Greet') {
            steps {
                echo 'ğŸ‘‹ Hello from Jenkins!'
            }
        }

        stage('System Info') {
            steps {
                sh 'echo "ğŸ–¥ï¸ Running as user: $(whoami)"'
                sh 'echo "ğŸ“… Current time: $(date)"'
                sh 'hostname'
            }
        }

        stage('Create Sample Files') {
            steps {
                sh '''
                    mkdir -p myapp
                    echo "This is a test file" > myapp/file1.txt
                    echo "Another test file" > myapp/file2.txt
                '''
            }
        }

        stage('List Files') {
            steps {
                sh 'ls -l myapp'
            }
        }

        stage('Simulate Build') {
            steps {
                echo 'âš™ï¸ Simulating build process...'
                sh 'sleep 2'
            }
        }

        stage('Fake Test') {
            steps {
                echo 'âœ… Running dummy tests...'
                sh 'echo "Test passed: true"'
            }
        }

        stage('Archive Files') {
            steps {
                sh 'tar -czf myapp.tar.gz myapp'
                echo 'ğŸ“¦ Archived files.'
            }
        }

        stage('Deploy Simulate') {
            steps {
                sh '''
                    mkdir -p deploy
                    mv myapp.tar.gz deploy/
                    echo "ğŸš€ Deployed to ./deploy folder"
                '''
            }
        }
    }

    post {
        success {
            echo 'ğŸ‰ Pipeline completed successfully!'
        }
        failure {
            echo 'âŒ Pipeline failed.'
        }
        always {
            echo 'ğŸ§¹ Cleaning up...'
            sh 'rm -rf myapp deploy *.tar.gz'
        }
    }
}
